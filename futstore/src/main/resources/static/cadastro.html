<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Produto</title>
    <link rel="stylesheet" href="./styles/styles.css" type="text/css">
    <script src="./scripts/script.js" defer></script>
</head>
<body>
    <div class="container" id="cadastroProduto">
        <h2>Cadastro de Produto</h2>
        <form id="formCadastroProduto" enctype="multipart/form-data">
            <!-- Nome do Produto -->
            <div class="form-group">
                <label for="nomeProduto">Nome do Produto:</label>
                <input type="text" id="nomeProduto" name="nomeProduto" maxlength="200" required>
            </div>

            <!-- Avaliação do Produto -->
            <div class="form-group">
                <label for="avaliacaoProduto">Avaliação (1 a 5):</label>
                <input type="number" id="avaliacaoProduto" name="avaliacaoProduto" min="0.5" max="5" step="0.5" required>
            </div>

            <!-- Descrição Detalhada -->
            <div class="form-group">
                <label for="descricaoProduto">Descrição Detalhada:</label>
                <textarea id="descricaoProduto" name="descricaoProduto" maxlength="2000" required></textarea>
            </div>

            <!-- Preço do Produto -->
            <div class="form-group">
                <label for="precoProduto">Preço (R$):</label>
                <input type="number" id="precoProduto" name="precoProduto" step="0.01" required>
            </div>

            <!-- Quantidade em Estoque -->
            <div class="form-group">
                <label for="qtdProduto">Quantidade em Estoque:</label>
                <input type="number" id="qtdProduto" name="qtdProduto" required>
            </div>

            <!-- Imagens do Produto -->
            <div class="form-group">
                <label for="imagensProduto">Imagens do Produto:</label>
                <input type="file" id="imagensProduto" name="imagensProduto[]" multiple accept="image/*">
                <div id="previewImagens"></div>
            </div>

            <!-- Imagem Principal -->
            <div class="form-group">
                <label for="imagemPrincipal">Definir imagem principal:</label>
                <select id="imagemPrincipal" name="imagemPrincipal">
                    <option value="">Selecione uma imagem</option>
                </select>
            </div>

            <!-- Botões de Ação -->
            <button type="submit" class="btn" id="btnSalvarProduto">Salvar</button>
            <button type="button" class="btnCancel" id="btnCancelarProduto">Cancelar</button>
        </form>
    </div>

    <script>
        // Função para mostrar as imagens carregadas no preview
        document.getElementById('imagensProduto').addEventListener('change', function(event) {
            let preview = document.getElementById('previewImagens');
            preview.innerHTML = '';  // Limpa o preview
            let imagemPrincipalSelect = document.getElementById('imagemPrincipal');
            imagemPrincipalSelect.innerHTML = '<option value="">Selecione uma imagem</option>';  // Limpa a seleção

            Array.from(event.target.files).forEach((file, index) => {
                let reader = new FileReader();
                reader.onload = function(e) {
                    let img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.width = '100px';  // Tamanho da imagem no preview
                    img.style.margin = '5px';
                    img.setAttribute('data-index', index); // Armazena o índice para referência posterior

                    // Adiciona a imagem ao preview
                    preview.appendChild(img);

                    // Adiciona as opções para selecionar a imagem principal
                    let selectOption = document.createElement('option');
                    selectOption.value = index;
                    selectOption.textContent = `Imagem ${index + 1}`;
                    imagemPrincipalSelect.appendChild(selectOption);
                };
                reader.readAsDataURL(file);
            });
        });

        // Ação do botão Salvar
        document.getElementById('formCadastroProduto').addEventListener('submit', function(event) {
            event.preventDefault(); // Evita o envio tradicional do formulário

            // Captura os dados do formulário
            let formData = new FormData(this);

            // Exemplo de requisição AJAX para salvar o produto no banco de dados
            /*
            fetch('/salvar-produto', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log('Produto salvo:', data);
                // Redirecionar ou atualizar a lista de produtos
            })
            .catch(error => console.error('Erro ao salvar produto:', error));
            */
        });

        // Ação do botão Cancelar
        document.getElementById('btnCancelarProduto').addEventListener('click', function() {
            // Redireciona para a lista de produtos
            window.location.href = "listaProdutos.html";
        });
    </script>
</body>
</html>
